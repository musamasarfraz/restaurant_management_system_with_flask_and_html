<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Financial Report</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/financial_report.css') }}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <a href="{{ url_for('main.index') }}" class="back-btn">Home</a>
    <h1>Financial Report</h1>
    <form id="financial-form" method="POST">
        <label for="year">Select Financial Year:</label>
        <select id="year" name="year" required>
            {% for year in range(datetime.now().year, 2019, -1) %}
                <option value="{{ year }}">{{ year }}</option>
            {% endfor %}
        </select>

        <label for="months">Select Months:</label>
        <div id="months">
            <label><input type="checkbox" name="months" value="1"> January</label>
            <label><input type="checkbox" name="months" value="2"> February</label>
            <label><input type="checkbox" name="months" value="3"> March</label>
            <label><input type="checkbox" name="months" value="4"> April</label>
            <label><input type="checkbox" name="months" value="5"> May</label>
            <label><input type="checkbox" name="months" value="6"> June</label>
            <label><input type="checkbox" name="months" value="7"> July</label>
            <label><input type="checkbox" name="months" value="8"> August</label>
            <label><input type="checkbox" name="months" value="9"> September</label>
            <label><input type="checkbox" name="months" value="10"> October</label>
            <label><input type="checkbox" name="months" value="11"> November</label>
            <label><input type="checkbox" name="months" value="12"> December</label>
        </div>

        <button type="button" id="generate-report-button">Generate Report</button>
    </form>

    <script>
        $(document).ready(function() {
            $('#generate-report-button').click(function() {
                generateReport();
            });

            function generateReport() {
                var year = $('#year').val();
                var months = [];
                $('#months input:checked').each(function() {
                    months.push($(this).val());
                });

                $.ajax({
                    type: 'POST',
                    url: '{{ url_for("main.generate_report") }}',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        'generate_report': true,
                        'year': year,
                        'months': months
                    }),
                    success: function(response) {
                        if (response.status === 'success') {
                            window.location.href = response.redirect_url;
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
